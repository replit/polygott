#!/bin/bash
set -ev
shopt -s dotglob

# Languages: <%= languages.map((l) => l.name).join(', ') %>

<% for ( let key of aptKeys ) { %>
apt-key adv --keyserver hkp://keyserver.ubuntu.com:80 --recv <%- c([key]) %>
<% } %>

<% for ( let keyUrl of aptKeyUrls ) { %>
curl -L <%- c([keyUrl]) %> | apt-key add -
<% } %>    

<% for ( let repo of aptRepos ) { %>
add-apt-repository -y <%- c([repo]) %>
<% } %>

DEBIAN_FRONTEND=noninteractive apt-get update -y
DEBIAN_FRONTEND=noninteractive apt-get install -y --no-install-recommends <%- packages.join(' ') %> || exit 1
rm -rf /var/lib/apt/lists/*

rm /phase1.sh
